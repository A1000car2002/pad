F [label = 'DIRECCIÓN DEL P.I. PRODUCCIÓN \nSUSTENTABLE Y BIOTECNOLOGÍA', fillcolor = '#99CCFF']
G [label = 'DIRECCIÓN DEL P.I. AGUA, \nSUELO Y CLIMA', fillcolor = '#99CCFF']
H [label = 'DIRECCIÓN DEL P.I. \nECO SOCIOECONOMÍA Y CAMBIO GLOBAL', fillcolor = '#99CCFF']
I [label = 'DIRECCIÓN DEL P.I. DE \nBIODIVERSIDAD Y MEDIO AMBIENTE', fillcolor = '#99CCFF']
J [label = 'Laboratorio de Fisiología y \nBiotecnología Vegetal']
K [label = 'Laboratorio de Sanidad Vegetal']
L [label = 'Centro de Investigación Hidropónico']
M [label = 'Centro de Investigación \nForestal y Agrosilvopastura']
N [label = 'Centro de Investigación en Cacao']
Ñ [label = 'Centro de Investigación en Café']
O [label = 'Centro de Investigación en \nFruticultura']
P [label = 'Proyectos de investigación']
Q [label = 'Laboratorio de Aguas y Suelos']
R [label = 'Laboratorio de Climatología \ny Energía Alternativa']
S [label = 'Laboratorio de Recursos Hídricos']
T [label = 'Laboratorio de Hidrogeoquímica']
U [label = 'Proyectos de investigación']
V [label = 'Centro de Investigación en \nDesarrollo Rural y Turismo']
W [label = 'Centro de Interpretación de \nEcología Humana']
X [label = 'Centro de Incestigación cultural']
Y [label = 'Centro de Investigación e \nInterpretación del cambio climático']
Z [label = 'Proyectos de Investigación']
AA [label = 'Laboratorio de Adaptación \nde Especies Vegetales']
AB [label = 'Laboratorio de Geomática y Teledetección']
AC [label = 'Laboartorio de Cromatografía']
AD [label = 'Proyectos de Investigación']
AE [label = 'Estación de Redes de \nMonitoreo Hidrogeometereológico', fillcolor = '#CCE5FF']
AF [label = 'Estación de Diversidad \nBiológica y Bosque', fillcolor = '#CCE5FF']
C [label = 'Coordinador de Servicios \nde Innovación y Tecnología', fillcolor = '#CCE5FF']
# Definir relaciones (aristas)
AG -> A
A -> B
A -> C
A -> D
A -> E
A -> F
A -> G
A -> H
A -> I
A -> AE
A -> AF
F -> J
F -> K
F -> L
F -> M
F -> N
F -> Ñ
F -> O
F -> P
G -> Q
G -> R
G -> S
G -> T
G -> U
H -> V
H -> W
H -> X
H -> Y
H -> Z
I -> AA
I -> AB
I -> AC
I -> AD
}
")
source('https://inkaverse.com/setup.r')
grViz("
digraph organizational_chart {
graph [
rankdir = LR
]
# Definir atributos de nodos globales
node [fontname = 'Times New Roman', fontsize = 12, shape = rectangle, style = filled, fillcolor = lightgrey]
edge [color = black, arrowhead = vee, arrowtail = none, dir = both, tailport = \"e\",
headport = \"w\"]
# Definir los nodos del diagrama
AG [label = 'DIRECTORIO', fillcolor = '#FFCC00']
A [label = 'DIRECCIÓN EJECUTIVA', fillcolor = '#FFCC00']
B [label = 'COORDINACIÓN DE ADMINISTRACIÓN', fillcolor = '#FFCC99']
D [label = 'COORDINACIÓN DE PLANEAMIENTO, \nSEGUIMIENTO Y MONITOREO', fillcolor = '#FFCC99']
E [label = 'COORDINACIÓN DE ENLACE INTERNACIONAL', fillcolor = '#FFCC99']
F [label = 'DIRECCIÓN DEL P.I. PRODUCCIÓN \nSUSTENTABLE Y BIOTECNOLOGÍA', fillcolor = '#99CCFF']
G [label = 'DIRECCIÓN DEL P.I. AGUA, \nSUELO Y CLIMA', fillcolor = '#99CCFF']
H [label = 'DIRECCIÓN DEL P.I. \nECO SOCIOECONOMÍA Y CAMBIO GLOBAL', fillcolor = '#99CCFF']
I [label = 'DIRECCIÓN DEL P.I. DE \nBIODIVERSIDAD Y MEDIO AMBIENTE', fillcolor = '#99CCFF']
J [label = 'Laboratorio de Fisiología y \nBiotecnología Vegetal']
K [label = 'Laboratorio de Sanidad Vegetal']
L [label = 'Centro de Investigación Hidropónico']
M [label = 'Centro de Investigación \nForestal y Agrosilvopastura']
N [label = 'Centro de Investigación en Cacao']
Ñ [label = 'Centro de Investigación en Café']
O [label = 'Centro de Investigación en \nFruticultura']
P [label = 'Proyectos de investigación']
Q [label = 'Laboratorio de Aguas y Suelos']
R [label = 'Laboratorio de Climatología \ny Energía Alternativa']
S [label = 'Laboratorio de Recursos Hídricos']
T [label = 'Laboratorio de Hidrogeoquímica']
U [label = 'Proyectos de investigación']
V [label = 'Centro de Investigación en \nDesarrollo Rural y Turismo']
W [label = 'Centro de Interpretación de \nEcología Humana']
X [label = 'Centro de Incestigación cultural']
Y [label = 'Centro de Investigación e \nInterpretación del cambio climático']
Z [label = 'Proyectos de Investigación']
AA [label = 'Laboratorio de Adaptación \nde Especies Vegetales']
AB [label = 'Laboratorio de Geomática y Teledetección']
AC [label = 'Laboartorio de Cromatografía']
AD [label = 'Proyectos de Investigación']
AE [label = 'Estación de Redes de \nMonitoreo Hidrogeometereológico', fillcolor = '#CCE5FF']
AF [label = 'Estación de Diversidad \nBiológica y Bosque', fillcolor = '#CCE5FF']
C [label = 'Coordinador de Servicios \nde Innovación y Tecnología', fillcolor = '#CCE5FF']
# Definir relaciones (aristas)
AG -> A
A -> B
A -> C
A -> D
A -> E
A -> F
A -> G
A -> H
A -> I
A -> AE
A -> AF
F -> J
F -> K
F -> L
F -> M
F -> N
F -> Ñ
F -> O
F -> P
G -> Q
G -> R
G -> S
G -> T
G -> U
H -> V
H -> W
H -> X
H -> Y
H -> Z
I -> AA
I -> AB
I -> AC
I -> AD
}
")
grViz("
digraph organizational_chart {
graph [
rankdir = LR
]
# Definir atributos de nodos globales
node [fontname = 'Times New Roman', fontsize = 12, shape = rectangle, style = filled, fillcolor = lightgrey]
edge [color = black, arrowhead = vee, arrowtail = none, dir = both, tailport = \"e\",
headport = \"w\"]
# Definir los nodos del diagrama
AG [label = 'DIRECTORIO', fillcolor = '#FFCC00']
A [label = 'DIRECCIÓN EJECUTIVA', fillcolor = '#FFCC00']
B [label = 'COORDINACIÓN DE ADMINISTRACIÓN', fillcolor = '#FFCC99']
D [label = 'COORDINACIÓN DE PLANEAMIENTO, \nSEGUIMIENTO Y MONITOREO', fillcolor = '#FFCC99']
E [label = 'COORDINACIÓN DE ENLACE INTERNACIONAL', fillcolor = '#FFCC99']
F [label = 'DIRECCIÓN DEL P.I. PRODUCCIÓN \nSUSTENTABLE Y BIOTECNOLOGÍA', fillcolor = '#99CCFF']
G [label = 'DIRECCIÓN DEL P.I. AGUA, \nSUELO Y CLIMA', fillcolor = '#99CCFF']
H [label = 'DIRECCIÓN DEL P.I. \nECO SOCIOECONOMÍA Y CAMBIO GLOBAL', fillcolor = '#99CCFF']
I [label = 'DIRECCIÓN DEL P.I. DE \nBIODIVERSIDAD Y MEDIO AMBIENTE', fillcolor = '#99CCFF']
J [label = 'Laboratorio de Fisiología y \nBiotecnología Vegetal']
K [label = 'Laboratorio de Sanidad Vegetal']
L [label = 'Centro de Investigación Hidropónico']
M [label = 'Centro de Investigación \nForestal y Agrosilvopastura']
N [label = 'Centro de Investigación en Cacao']
Ñ [label = 'Centro de Investigación en Café']
O [label = 'Centro de Investigación en \nFruticultura']
P [label = 'Proyectos de investigación']
Q [label = 'Laboratorio de Aguas y Suelos']
R [label = 'Laboratorio de Climatología \ny Energía Alternativa']
S [label = 'Laboratorio de Recursos Hídricos']
T [label = 'Laboratorio de Hidrogeoquímica']
U [label = 'Proyectos de investigación']
V [label = 'Centro de Investigación en \nDesarrollo Rural y Turismo']
W [label = 'Centro de Interpretación de \nEcología Humana']
X [label = 'Centro de Incestigación cultural']
Y [label = 'Centro de Investigación e \nInterpretación del cambio climático']
Z [label = 'Proyectos de Investigación']
AA [label = 'Laboratorio de Adaptación \nde Especies Vegetales']
AB [label = 'Laboratorio de Geomática y Teledetección']
AC [label = 'Laboartorio de Cromatografía']
AD [label = 'Proyectos de Investigación']
AE [label = 'Estación de Redes de \nMonitoreo Hidrogeometereológico', fillcolor = '#CCE5FF']
AF [label = 'Estación de Diversidad \nBiológica y Bosque', fillcolor = '#CCE5FF']
C [label = 'Coordinador de Servicios \nde Innovación y Tecnología', fillcolor = '#CCE5FF']
# Definir relaciones (aristas)
AG -> A
A -> B
A -> C
A -> D
A -> E
A -> F
A -> G
A -> H
A -> I
A -> AE
A -> AF
F -> J
F -> K
F -> L
F -> M
F -> N
F -> Ñ
F -> O
F -> P
G -> Q
G -> R
G -> S
G -> T
G -> U
H -> V
H -> W
H -> X
H -> Y
H -> Z
I -> AA
I -> AB
I -> AC
I -> AD
}
")
source('https://inkaverse.com/setup.r')
url <- "https://docs.google.com/spreadsheets/d/15r7ZwcZZHbEgltlF6gSFvCTFA-CFzVBWwg3mFlRyKPs/edit?gid=172957346#gid=172957346"
gs <- url %>%
as_sheets_id()
fb <- gs %>%
range_read("fb")
str(fb)
modelo <- aov(formula = lfa ~ bloque + riego + geno + riego*geno
, data =fb)
anova(modelo)
plot(modelo)
y = "Área foliar (cm^2)")
modelo <- aov(formula = hi ~ bloque + riego + geno + riego*geno
, data =fb)
anova(modelo)
plot(modelo)
y = "Área foliar (cm^2)")
library(lme4)
model <- lme4::lmer(formula = lfa ~ riego + geno + riego * geno + (1 | bloque), data = fb)
anova(model)
plot(model)
ol <- boxplot(lfa ~ riego * geno, fb)
ol
library(inti)
model <- remove_outliers(data = fb
,formula = lfa ~ riego + geno + riego * geno+ (1 | bloque)
, plot_diag = T
)
model
modelo <- lm(formula = lfa ~ bloque + riego + geno + riego * geno, data = fb)
anova(modelo)
library(agricolae)
tukey_result <- HSD.test(modelo, c("geno", "riego"), group = TRUE)
print(tukey_result)
plot(tukey_result)
tukey_result
grupos <- tukey_result$groups %>%
rownames_to_column("tratamientos") %>%
separate(tratamientos, into = c("geno", "riego"), sep = ":")
str(grupos)
# Cargar las bibliotecas necesarias
library(agricolae)
library(ggplot2)
library(dplyr)
library(tidyr)
# Ajustar el modelo lineal
modelo <- lm(formula = lfa ~ bloque + riego + geno + riego * geno, data = fb)
# Obtener el resultado de Tukey
tukey_result <- HSD.test(modelo, c("geno", "riego"), group = TRUE)
# Crear un dataframe con los grupos y separar los tratamientos
grupos <- tukey_result$groups %>%
rownames_to_column("tratamientos") %>%
separate(tratamientos, into = c("geno", "riego"), sep = ":")
# Verificar la estructura del dataframe y los nombres de las columnas
str(grupos)
print(colnames(grupos))  # Verificar nombres de columnas
# Crear el gráfico de barras
ggplot(grupos, aes(x = geno, y = lfa, fill = riego)) +  # Asegúrate de que "LFA" sea el nombre correcto
geom_bar(stat = "identity", position = position_dodge(), color = "black") +
labs(title = "Comparación de Medias - Prueba de Tukey",
x = "Genotipos",
y = "FTL") +
theme_minimal() +
theme(legend.title = element_blank()) +
scale_fill_discrete(name = "Riego")
# Crear el gráfico de barras con letras estadísticas
ggplot(grupos, aes(x = geno, y = lfa, fill = riego)) +  # Asegúrate de que "lfa" sea el nombre correcto
geom_bar(stat = "identity", position = position_dodge(), color = "black") +
labs(title = "Comparación de Medias - Prueba de Tukey",
x = "Genotipos",
y = "FTL") +
theme_minimal() +
theme(legend.title = element_blank()) +
scale_fill_discrete(name = "Riego") +
geom_text(aes(label = groups, y = lfa + 0.05),  # Usar 'groups' en lugar de 'M'
position = position_dodge(0.9), vjust = 0)  # Ajustar el espaciado de las letras
model <- lme4::lmer(formula = hi ~ riego + geno + riego * geno + (1 | bloque), data = fb)
anova(model)
library(emmeans)
library(multicmp)
library(multcompView)
cm1 <- emmeans(model, ~ geno | riego) %>%
cld(Letters=letters, reversed = T)
cm1
cm2 <- emmeans(model, ~ riego | geno) %>%
cld(Letters=letters, reversed = T)
cm2
cm3 <- emmeans(model, ~ riego * geno) %>%
cld(Letters=letters, reversed = T)
cm3
# Convertir las medias estimadas a un dataframe
cm1_df <- as.data.frame(cm1)
# Ver el contenido del dataframe para asegurarnos de que tiene las columnas correctas
print(cm1_df)
# Crear el gráfico de barras con los resultados de las medias estimadas de emmeans
ggplot(cm1_df, aes(x = geno, y = emmean, fill = riego)) +  # Cambia "emmean" por la columna de las medias estimadas
geom_bar(stat = "identity", position = position_dodge(), color = "black") +
labs(title = "Comparación de Medias - Medias Estimadas",
x = "Genotipos",
y = "hi") +
theme_minimal() +
theme(legend.title = element_blank()) +
scale_fill_discrete(name = "Riego")
dtcm <- as.data.frame(cm2) %>%
rename(sig = ".group")
ggplot(dtcm, aes(x = geno, y = emmean, fill = riego)) +
geom_bar(stat = "identity", position = "dodge", color = "black") +
geom_text(aes(label = sig, y = emmean*1*1),
position = position_dodge(width = 0.9),
vjust = 0) +
labs(x = "Genotipo", y = "HI", fill = "Riego") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Gráfico de barras: LFA por genotipo y riego")
str(fb)
library(tidyverse)
library(psych)
fb %>%
select_if(is.numeric) %>%
dplyr::select(!c("block")) %>%
pairs.panels(x = .
, hist.col="red"
, pch = 21
, stars = TRUE
, scale = FALSE
, lm = TRUE
)
library(FactoMineR)
mv <- fb %>%
group_by(riego, geno) %>%
summarise(across(where(is.numeric), ~ mean(., na.rm =TRUE))) %>%
PCA(scale.unit = T, quali.sup = c(1:4), graph = F)
p1 <- plot(mv
, choix="ind"
, habillage=1)
p2 <- plot(mv
, choix="var")
list(p1, p2) %>%
plot_grid(plotlist = .,nrow = 1)
fb %>%
ggplot(data = ., aes(x = geno, y = hi))
fb %>%
ggplot(data = ., aes(x = geno, y = hi) +
geom_boxplot())
fb %>%
ggplot(data = ., aes(x = geno, y = hi)) +
geom_boxplot()
fb %>%
ggplot(data = ., aes(x = geno, y = hi, fill = riego)) +
geom_boxplot()
fb %>%
ggplot(data = ., aes(x = geno, y = hi, fill = riego)) +
geom_boxplot()
fb %>%
ggplot(data = ., aes(x = geno, y = hi, fill = riego)) +
geom_boxplot() + labs(x="Genotipos"
, y = "Indice de cosecha"
, fill = "Tratamiento")
fb %>%
ggplot(aes(x = geno, y = hi, color = riego)) +
geom_point() +
labs(x = "Genotipos",
y = "Índice de cosecha",
color = "Tratamiento",
title = "Eficiencia de riego")
fb %>%
ggplot(aes(x = geno, y = lfa, color = riego)) +
geom_point() +
labs(x = "Genotipos",
y = "Índice de cosecha",
color = "Tratamiento",
title = "Eficiencia de riego",
)
fb %>%
ggplot(aes(x = geno, y = lfa, color = riego)) +
geom_point() +
labs(x = "Genotipos",
y = "Área foliar",
color = "Tratamiento",
title = "Eficiencia de riego",
)
fb %>%
ggplot(aes(x = wue, y = lfa, color = riego)) +
geom_point() +
labs(x = "Genotipos",
y = "Área foliar",
color = "Tratamiento",
title = "Eficiencia de riego",
)
fb %>%
ggplot(data = ., aes(x = geno, y = hi, fill = riego)) +
geom_boxplot() + labs(x="Genotipos"
, y = "Indice de cosecha"
, fill = "Tratamiento"
, title = "Eficiencia de riego"
, subtitle = "Índice de cosecha")
fb %>%
ggplot(data = ., aes(x = geno, y = hi, fill = riego)) +
geom_boxplot() + labs(x="Genotipos"
, y = "Indice de cosecha"
, fill = "Tratamiento"
, title = "Eficiencia de riego"
, subtitle = "Índice de cosecha"
,caption = "n = 50")
fb %>%
ggplot(data = ., aes(x = wue, y = hi, fill = riego)) +
geom_point() + labs(x="Genotipos"
, y = "Indice de cosecha"
, fill = "Tratamiento"
, title = "Eficiencia de riego"
, subtitle = "Índice de cosecha"
,caption = "n = 50")
fb %>%
ggplot(data = ., aes(x = wue, y = hi, colour = riego)) +
geom_point() + labs(x="Genotipos"
, y = "Indice de cosecha"
, fill = "Tratamiento"
, title = "Eficiencia de riego"
, subtitle = "Índice de cosecha"
,caption = "n = 50")
fb %>%
ggplot(data = ., aes(x = wue, y = hi, colour = riego)) +
geom_point() + labs(x="Eficiencia del uso del agua"
, y = "Indice de cosecha"
, fill = "Tratamiento"
, title = "Eficiencia del uso del agua en papa"
, subtitle = "Eficiencia del uso del agua en tubérculo "
,caption = "n = 150") +
theme_bw()
fb %>%
ggplot(data = ., aes(x = geno, y = hi, fill = riego)) +
geom_boxplot() + labs(x="Genotipos"
, y = "Indice de cosecha"
, fill = "Tratamiento"
, title = "Eficiencia de riego"
, subtitle = "Índice de cosecha"
,caption = "n = 150") +
theme_classic()
fb %>%
ggplot(data = ., aes(x = wue, y = hi, colour = riego)) +
geom_point() + labs(x="Eficiencia del uso del agua"
, y = "Indice de cosecha"
, fill = "Tratamiento"
, title = "Eficiencia del uso del agua en papa"
, subtitle = "Eficiencia del uso del agua en tubérculo "
,caption = "n = 150") +
theme_bw()
modelo <- lm(lfa ~ bloque + riego + geno + riego * geno, data = fb)
anova(modelo)
modelo <- lm(lfa ~ bloque + riego + geno + riego * geno, data = fb)
anova(modelo)
library(agricolae)
tukey_result <- HSD.test(modelo, c("geno", "riego"), group = TRUE)
print(tukey_result)
plot(tukey_result)
tukey_result <- HSD.test(modelo, c("geno", "riego"), group = TRUE)
print(tukey_result)
plot(tukey_result)
modelo <- lm(formula = lfa ~ bloque + riego + geno + riego * geno, data = fb)
tukey_result <- HSD.test(modelo, c("geno", "riego"), group = TRUE)
grupos <- tukey_result$groups %>%
rownames_to_column("tratamientos") %>%
separate(tratamientos, into = c("geno", "riego"), sep = ":")
grupos %>%
ggplot(data = ., aes(x = geno, y = hi, fill = riego)) +
geom_bar()
grupos %>%
ggplot(data = ., aes(x = geno, y = hi, fill = riego)) +
geom_bar()
grupos %>%
ggplot(data = ., aes(x = geno, y = lfa, fill = riego)) +
geom_bar()
grupos %>%
ggplot(data = ., aes(x = geno, y = lfa, fill = riego)) +
geom_col()
grupos %>%
ggplot(data = ., aes(x = geno, y = lfa, fill = riego)) +
geom_col() + labs(x="Eficiencia del uso del agua"
, y = "Indice de cosecha"
, fill = "Tratamiento"
, title = "Eficiencia del uso del agua en papa"
, subtitle = "Eficiencia del uso del agua en tubérculo "
,caption = "n = 150")
grupos %>%
ggplot(data = ., aes(x = geno, y = lfa, fill = riego)) +
geom_col(position = position_dodge2(preserve = "single"))
